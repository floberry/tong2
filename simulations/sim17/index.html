<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì „ê¸° ì—ë„ˆì§€ íš¨ìœ¨ ë¹„êµ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Malgun Gothic', sans-serif;
            background: linear-gradient(135deg, #2d1a2d 0%, #4a2d4a 100%);
            color: #f0e0f0;
            padding: 15px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 500px;
            margin: 0 auto;
            background: #3d2a3d;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 8px 32px rgba(255, 105, 180, 0.2);
        }
        
        h1 {
            text-align: center;
            color: #ffb3d9;
            font-size: 22px;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #d981b8;
        }
        
        .problem-number {
            font-size: 16px;
            font-weight: bold;
            color: #ffcceb;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .bunny-icon {
            font-size: 20px;
            animation: wiggle 1.5s ease-in-out infinite;
        }
        
        @keyframes wiggle {
            0%, 100% { transform: rotate(-5deg); }
            50% { transform: rotate(5deg); }
        }
        
        .problem-area {
            background: #4a334a;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            border: 1px solid #d981b8;
        }
        
        .problem-text {
            font-size: 15px;
            line-height: 1.8;
            margin-bottom: 20px;
            color: #ffe0f0;
        }
        
        .table-container {
            overflow-x: auto;
            margin: 20px 0;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            background: #5a3d5a;
            border-radius: 8px;
            overflow: hidden;
        }
        
        th, td {
            padding: 12px;
            text-align: left;
            border: 1px solid #d981b8;
            font-size: 14px;
        }
        
        th {
            background: #7a4d7a;
            color: #ffcceb;
            font-weight: bold;
        }
        
        td {
            color: #e6b3d6;
        }
        
        .power-station {
            background: #5a3d5a;
            padding: 15px;
            border-radius: 8px;
            border: 3px solid #b366a3;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 15px;
        }
        
        .power-station:hover {
            background: #6a4a6a;
            transform: translateY(-2px);
        }
        
        .power-station.selected {
            border-color: #ff99cc;
            background: #7a4d7a;
        }
        
        .station-header {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 5px;
            color: #ffcceb;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .selection-order {
            background: #ff99cc;
            color: #2d1a2d;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 16px;
        }
        
        .station-type {
            font-size: 13px;
            color: #e6b3d6;
            margin-bottom: 5px;
        }
        
        .answer-area {
            background: #4a334a;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        
        .question-text {
            font-size: 15px;
            line-height: 1.6;
            margin-bottom: 15px;
            color: #ffe0f0;
        }
        
        .answer-display {
            text-align: center;
            font-size: 20px;
            font-weight: bold;
            padding: 15px;
            background: #5a3d5a;
            border-radius: 8px;
            margin: 15px 0;
            color: #ffcceb;
            min-height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        
        button {
            flex: 1;
            padding: 15px;
            font-size: 16px;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .new-problem-btn {
            background: #d981b8;
            color: #2d1a2d;
        }
        
        .new-problem-btn:hover {
            background: #e699cc;
            transform: translateY(-2px);
        }
        
        .submit-btn {
            background: #ff99cc;
            color: #2d1a2d;
        }
        
        .submit-btn:hover {
            background: #ffb3d9;
            transform: translateY(-2px);
        }
        
        .submit-btn:disabled {
            background: #6a4a6a;
            color: #8a6a8a;
            cursor: not-allowed;
            transform: none;
        }
        
        .feedback {
            margin-top: 20px;
            padding: 20px;
            border-radius: 10px;
            font-size: 15px;
            line-height: 1.8;
        }
        
        .feedback.correct {
            background: #3d4a3d;
            border: 2px solid #6b996b;
            color: #c4e6c4;
        }
        
        .feedback.incorrect {
            background: #5a3d4a;
            border: 2px solid #cc6699;
            color: #ffcce6;
        }
        
        .feedback-title {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 15px;
            color: #ffcceb;
        }
        
        .solution {
            background: #5a3d5a;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            border-left: 4px solid #ff99cc;
        }
        
        .solution-step {
            margin: 10px 0;
            padding-left: 10px;
        }
        
        .formula {
            background: #4a2d4a;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            text-align: center;
            color: #ffb3d9;
        }
        
        .error-box {
            background: #4a2d3d;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            border: 2px solid #cc6699;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>âš¡ ì „ê¸° ì—ë„ˆì§€ íš¨ìœ¨ ë¹„êµ</h1>
        
        <div class="problem-area">
            <div class="problem-number">
                <span>10.</span>
                <span class="bunny-icon">ğŸ°</span>
            </div>
            <div class="problem-text">
                í‘œëŠ” ì „ê¸° ì—ë„ˆì§€ë¥¼ ìƒì‚°í•˜ëŠ” ë°œì „ì†Œ A, B, Cì— ëŒ€í•œ ìë£Œì´ë‹¤.
            </div>
            
            <div class="table-container">
                <table id="dataTable">
                    <thead>
                        <tr>
                            <th>ë°œì „ì†Œ</th>
                            <th>ë°œì „ ë°©ì‹</th>
                            <th>íŠ¹ì§•</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody">
                    </tbody>
                </table>
            </div>
        </div>
        
        <div class="answer-area">
            <div class="question-text">
                ê³µê¸‰ëœ ì—ë„ˆì§€ì˜ ì–‘ì´ ê°™ì„ ë•Œ, A, B, Cì—ì„œ ìƒì‚°í•˜ëŠ” ì „ê¸° ì—ë„ˆì§€ì˜ ì–‘ì„ ì˜³ê²Œ ë¹„êµí•œ ê²ƒì€? [1.5ì ]
            </div>
            <div class="answer-display" id="answerDisplay">ë°œì „ì†Œë¥¼ í´ë¦­í•˜ì—¬ ìˆœì„œë¥¼ ì •í•˜ì„¸ìš”</div>
            
            <div id="stationsContainer"></div>
            
            <div class="button-group">
                <button class="new-problem-btn" onclick="generateNewProblem()">ğŸ”„ ìƒˆ ë¬¸ì œ</button>
                <button class="submit-btn" id="submitBtn" onclick="checkAnswer()" disabled>âœ“ ì •ë‹µ í™•ì¸</button>
            </div>
        </div>
        
        <div class="feedback" id="feedback" style="display:none;"></div>
    </div>

    <script>
        let currentProblem = {};
        let selectedOrder = [];
        
        const powerPlants = [
            { type: 'ìˆ˜ë ¥ ë°œì „', desc: 'ë†’ì€ ê³³ì—ì„œ ë–¨ì–´ì§€ëŠ” ë¬¼ì˜ ì—­í•™ì  ì—ë„ˆì§€', unit: 'MJ' },
            { type: 'íƒœì–‘ê´‘ ë°œì „', desc: 'íƒœì–‘ ì „ì§€ë¥¼ ë¹„ì¶”ëŠ” ë¹›ì˜ ì—ë„ˆì§€ê°€', unit: 'kJ' },
            { type: 'í™”ë ¥ ë°œì „', desc: 'ì˜ í™”í•™ ì—ë„ˆì§€ë¥¼ ê°€ì§„ í™”ì„ ì—°ë£Œ', unit: 'g_kJ' }
        ];
        
        function getRandomValue() {
            return (Math.floor(Math.random() * 10) + 1) * 10;
        }
        
        function generateNewProblem() {
            const shuffled = [...powerPlants].sort(() => Math.random() - 0.5);
            const devices = {};
            
            ['A', 'B', 'C'].forEach((letter, index) => {
                const plant = shuffled[index];
                let inputEnergy, outputEnergy;
                
                if (plant.unit === 'kJ') {
                    inputEnergy = getRandomValue() * 20;
                    outputEnergy = getRandomValue() * 10;
                } else if (plant.unit === 'g_kJ') {
                    const fuelMass = getRandomValue() / 10;
                    const energyPerGram = getRandomValue() * 2;
                    devices[letter] = {
                        type: plant.type,
                        fuelMass: fuelMass,
                        energyPerGram: energyPerGram,
                        inputEnergy: (fuelMass * energyPerGram) / 1000,
                        outputEnergy: getRandomValue(),
                        unit: 'MJ',
                        desc: plant.desc
                    };
                    return;
                } else {
                    inputEnergy = getRandomValue();
                    outputEnergy = getRandomValue();
                }
                
                devices[letter] = {
                    type: plant.type,
                    inputEnergy: inputEnergy,
                    outputEnergy: outputEnergy,
                    unit: plant.unit,
                    desc: plant.desc
                };
            });
            
            const efficiencies = {};
            ['A', 'B', 'C'].forEach(letter => {
                const device = devices[letter];
                let inputMJ = device.inputEnergy;
                let outputMJ = device.outputEnergy;
                
                if (device.unit === 'kJ') {
                    inputMJ = device.inputEnergy / 1000;
                    outputMJ = device.outputEnergy / 1000;
                }
                
                efficiencies[letter] = (outputMJ / inputMJ * 100).toFixed(1);
            });
            
            const sorted = Object.entries(efficiencies)
                .sort((a, b) => parseFloat(b[1]) - parseFloat(a[1]))
                .map(entry => entry[0]);
            
            currentProblem = {
                devices: devices,
                efficiencies: efficiencies,
                correctAnswer: sorted.join(' > ')
            };
            
            selectedOrder = [];
            displayProblem();
            updateAnswerDisplay();
            document.getElementById('feedback').style.display = 'none';
            document.getElementById('submitBtn').disabled = true;
        }
        
        function displayProblem() {
            const tableBody = document.getElementById('tableBody');
            tableBody.innerHTML = '';
            
            ['A', 'B', 'C'].forEach(letter => {
                const data = currentProblem.devices[letter];
                const row = document.createElement('tr');
                
                let featureText = '';
                if (data.type === 'í™”ë ¥ ë°œì „') {
                    featureText = `${data.fuelMass}gë‹¹ ${data.energyPerGram}kJ${data.desc} ${data.fuelMass}kgì„ ì‚¬ìš©í•˜ì—¬ ${data.outputEnergy}MJì˜ ì „ê¸° ì—ë„ˆì§€ë¥¼ ìƒì‚°í•œë‹¤.`;
                } else if (data.unit === 'kJ') {
                    featureText = `${data.desc} ${data.inputEnergy}kJì¼ ë•Œ, ${data.outputEnergy}Jì˜ ì „ê¸° ì—ë„ˆì§€ë¥¼ ìƒì‚°í•œë‹¤.`;
                } else {
                    featureText = `${data.desc} ${data.inputEnergy}MJë‹¹ ${data.outputEnergy}MJì˜ ì „ê¸° ì—ë„ˆì§€ë¥¼ ìƒì‚°í•œë‹¤.`;
                }
                
                row.innerHTML = `
                    <td><strong>${letter}</strong></td>
                    <td>${data.type}</td>
                    <td>${featureText}</td>
                `;
                
                tableBody.appendChild(row);
            });
            
            const container = document.getElementById('stationsContainer');
            container.innerHTML = '';
            
            ['A', 'B', 'C'].forEach(letter => {
                const div = document.createElement('div');
                div.className = 'power-station';
                div.id = `station${letter}`;
                div.onclick = () => selectStation(letter);
                
                div.innerHTML = `
                    <div class="station-header">
                        <div>
                            <div>ë°œì „ì†Œ ${letter}</div>
                            <div class="station-type">${currentProblem.devices[letter].type}</div>
                        </div>
                        <span class="selection-order" id="order${letter}" style="display: none;"></span>
                    </div>
                `;
                
                container.appendChild(div);
            });
        }
        
        function selectStation(letter) {
            const index = selectedOrder.indexOf(letter);
            
            if (index > -1) {
                selectedOrder.splice(index, 1);
            } else {
                if (selectedOrder.length < 3) {
                    selectedOrder.push(letter);
                }
            }
            
            updateAnswerDisplay();
        }
        
        function updateAnswerDisplay() {
            ['A', 'B', 'C'].forEach(letter => {
                document.getElementById(`station${letter}`).classList.remove('selected');
                document.getElementById(`order${letter}`).style.display = 'none';
            });
            
            selectedOrder.forEach((letter, index) => {
                document.getElementById(`station${letter}`).classList.add('selected');
                const orderSpan = document.getElementById(`order${letter}`);
                orderSpan.textContent = index + 1;
                orderSpan.style.display = 'flex';
            });
            
            const display = document.getElementById('answerDisplay');
            if (selectedOrder.length === 0) {
                display.textContent = 'ë°œì „ì†Œë¥¼ í´ë¦­í•˜ì—¬ ìˆœì„œë¥¼ ì •í•˜ì„¸ìš”';
            } else {
                display.textContent = selectedOrder.join(' > ');
            }
            
            document.getElementById('submitBtn').disabled = selectedOrder.length !== 3;
        }
        
        function checkAnswer() {
            const userAnswer = selectedOrder.join(' > ');
            const isCorrect = userAnswer === currentProblem.correctAnswer;
            
            const feedback = document.getElementById('feedback');
            feedback.style.display = 'block';
            feedback.className = 'feedback ' + (isCorrect ? 'correct' : 'incorrect');
            
            let html = '';
            
            if (isCorrect) {
                html += `<div class="feedback-title">âœ“ ì •ë‹µì…ë‹ˆë‹¤!</div>`;
                html += `<div class="solution">`;
                html += `<strong>ğŸ¯ ì •ë‹µ:</strong> <span style="font-size: 18px; color: #b3e6b3;">${currentProblem.correctAnswer}</span><br><br>`;
                html += `<strong>ğŸ“ ì •ë‹µì¸ ì´ìœ :</strong><br>`;
                html += `ê³µê¸‰ëœ ì—ë„ˆì§€ì˜ ì–‘ì´ ê°™ì„ ë•Œ, ì—ë„ˆì§€ íš¨ìœ¨ì´ ë†’ì„ìˆ˜ë¡ ë” ë§ì€ ì „ê¸° ì—ë„ˆì§€ë¥¼ ìƒì‚°í•©ë‹ˆë‹¤. ê° ë°œì „ì†Œì˜ íš¨ìœ¨ì„ ê³„ì‚°í•œ ê²°ê³¼ê°€ ì •í™•í•©ë‹ˆë‹¤.<br><br>`;
            } else {
                html += `<div class="feedback-title">âœ— ì˜¤ë‹µì…ë‹ˆë‹¤.</div>`;
                html += `<div class="solution">`;
                html += `<div class="error-box">`;
                html += `<strong>âš ï¸ ì…ë ¥í•œ ë‹µ:</strong> <span style="font-size: 18px; color: #ffcccc;">${userAnswer}</span><br><br>`;
                html += `<strong>âŒ ì˜¤ë‹µì¸ ì´ìœ :</strong><br>`;
                
                const correctOrder = currentProblem.correctAnswer.split(' > ');
                const userOrder = userAnswer.split(' > ');
                
                let wrongCount = 0;
                for (let i = 0; i < 3; i++) {
                    if (correctOrder[i] !== userOrder[i]) {
                        wrongCount++;
                        const correctEff = currentProblem.efficiencies[correctOrder[i]];
                        const userEff = currentProblem.efficiencies[userOrder[i]];
                        html += `â€¢ ${i+1}ë²ˆì§¸ ìë¦¬: ë°œì „ì†Œ ${userOrder[i]} (íš¨ìœ¨ ${userEff}%)ë¥¼ ì„ íƒí–ˆìœ¼ë‚˜, ì‹¤ì œë¡œëŠ” ë°œì „ì†Œ ${correctOrder[i]} (íš¨ìœ¨ ${correctEff}%)ê°€ ì •ë‹µì…ë‹ˆë‹¤.<br>`;
                    }
                }
                
                if (wrongCount === 3) {
                    html += `<br>ğŸ’¡ <strong>íŒíŠ¸:</strong> ìˆœì„œê°€ ì™„ì „íˆ ë°˜ëŒ€ì…ë‹ˆë‹¤. íš¨ìœ¨ì´ ë†’ì€ ìˆœì„œë¡œ ë‹¤ì‹œ ë°°ì—´í•´ë³´ì„¸ìš”.`;
                } else if (wrongCount === 2) {
                    html += `<br>ğŸ’¡ <strong>íŒíŠ¸:</strong> ë‘ ë°œì „ì†Œì˜ ìœ„ì¹˜ê°€ ë°”ë€Œì—ˆìŠµë‹ˆë‹¤. íš¨ìœ¨ì„ ë‹¤ì‹œ ë¹„êµí•´ë³´ì„¸ìš”.`;
                }
                
                html += `</div><br>`;
                html += `<strong>ğŸ¯ ì •ë‹µ:</strong> <span style="font-size: 18px; color: #ffb3d9;">${currentProblem.correctAnswer}</span><br><br>`;
                html += `<strong>ğŸ“ ì •ë‹µì¸ ì´ìœ :</strong><br>`;
                html += `ê³µê¸‰ëœ ì—ë„ˆì§€ì˜ ì–‘ì´ ê°™ì„ ë•Œ, ì—ë„ˆì§€ íš¨ìœ¨ì´ ë†’ì„ìˆ˜ë¡ ë” ë§ì€ ì „ê¸° ì—ë„ˆì§€ë¥¼ ìƒì‚°í•©ë‹ˆë‹¤. ë”°ë¼ì„œ íš¨ìœ¨ì„ ê³„ì‚°í•˜ì—¬ ë†’ì€ ìˆœì„œë¡œ ë‚˜ì—´í•´ì•¼ í•©ë‹ˆë‹¤.<br><br>`;
            }
            
            html += `<div class="formula">ì—ë„ˆì§€ íš¨ìœ¨(%) = (ìƒì‚°ëœ ì „ê¸° ì—ë„ˆì§€ / ê³µê¸‰ëœ ì—ë„ˆì§€) Ã— 100</div>`;
            html += `<div class="formula">ê³µê¸‰ ì—ë„ˆì§€ê°€ ê°™ë‹¤ë©´ â†’ íš¨ìœ¨ì´ ë†’ì„ìˆ˜ë¡ ìƒì‚°ëŸ‰ â†‘</div>`;
            
            html += `<br><strong>ğŸ’¡ ê° ë°œì „ì†Œì˜ íš¨ìœ¨ ê³„ì‚°:</strong><br>`;
            
            const sortedDevices = Object.entries(currentProblem.efficiencies)
                .sort((a, b) => parseFloat(b[1]) - parseFloat(a[1]));
            
            sortedDevices.forEach(([letter, eff], index) => {
                const data = currentProblem.devices[letter];
                html += `<div class="solution-step">`;
                html += `<strong>${index + 1}ìœ„. ë°œì „ì†Œ ${letter} (${data.type}) - íš¨ìœ¨ ${eff}%</strong><br>`;
                
                if (data.type === 'í™”ë ¥ ë°œì „') {
                    const totalInput = data.fuelMass * data.energyPerGram;
                    html += `â€¢ ê³µê¸‰ ì—ë„ˆì§€: ${data.fuelMass}g Ã— ${data.energyPerGram}kJ/g = ${totalInput}kJ = ${data.inputEnergy.toFixed(2)}MJ<br>`;
                    html += `â€¢ ìƒì‚° ì—ë„ˆì§€: ${data.outputEnergy}MJ<br>`;
                    html += `â€¢ íš¨ìœ¨: (${data.outputEnergy} Ã· ${data.inputEnergy.toFixed(2)}) Ã— 100 = <strong>${eff}%</strong>`;
                } else if (data.unit === 'kJ') {
                    html += `â€¢ ê³µê¸‰ ì—ë„ˆì§€: ${data.inputEnergy}kJ = ${(data.inputEnergy/1000).toFixed(2)}MJ<br>`;
                    html += `â€¢ ìƒì‚° ì—ë„ˆì§€: ${data.outputEnergy}J = ${(data.outputEnergy/1000).toFixed(3)}MJ<br>`;
                    html += `â€¢ íš¨ìœ¨: (${(data.outputEnergy/1000).toFixed(3)} Ã· ${(data.inputEnergy/1000).toFixed(2)}) Ã— 100 = <strong>${eff}%</strong>`;
                } else {
                    html += `â€¢ ê³µê¸‰ ì—ë„ˆì§€: ${data.inputEnergy}MJ<br>`;
                    html += `â€¢ ìƒì‚° ì—ë„ˆì§€: ${data.outputEnergy}MJ<br>`;
                    html += `â€¢ íš¨ìœ¨: (${data.outputEnergy} Ã· ${data.inputEnergy}) Ã— 100 = <strong>${eff}%</strong>`;
                }
                html += `</div>`;
            });
            
            html += `<br><strong>ğŸ“Š ê²°ë¡ :</strong><br>`;
            html += `íš¨ìœ¨ ìˆœì„œ: ${sortedDevices[0][0]} (${sortedDevices[0][1]}%) > ${sortedDevices[1][0]} (${sortedDevices[1][1]}%) > ${sortedDevices[2][0]} (${sortedDevices[2][1]}%)<br>`;
            html += `ë”°ë¼ì„œ ìƒì‚°í•˜ëŠ” ì „ê¸° ì—ë„ˆì§€ë„ <strong style="color: #ffb3d9;">${currentProblem.correctAnswer}</strong> ìˆœì„œì…ë‹ˆë‹¤.`;
            
            html += `</div>`;
            
            feedback.innerHTML = html;
        }
        
        generateNewProblem();
    </script>
</body>
</html>